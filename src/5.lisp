(uiop:define-package aoc-2022.5
  (:use :cl
   :aoc-2022.day)
  (:import-from :cl-ppcre
   #:all-matches-as-strings)
  (:export #:day-5
   #:run
   #:run-sample-1
   #:run-sample-2))
(in-package :aoc-2022.5)
(setq *print-pretty* t)


(defclass day-5 (day)
  ((day
     :initform 5)))

(defun run (&optional sample)
  (let ((day (make-instance 'day-5)))
    (if sample
        (do-run-sample day)
        (do-run day))))

(defmethod part-1 ((this day-5) input)
  (multiple-value-bind (init instructions)
      (parse-input input)
    (let* ((final-result (reduce #'do-instruction instructions :initial-value init))
           (heads (mapcar #'car final-result)))
     (format nil "窿桢徜螬┅ㄤ彐礤翳镤疳螋è翳轶溽旦轭瘐舂⒃桢抿狒逋秭弪拱氨轶铒翎忪骘磲铢铄犷屮汩糸铉驽狒躜弩衢泔钿轸轱铋铉戾狒桢箦狒蟋犷屮趄沲栾熹弪犷翳徕殪轸麸痖汶躔犷盹鲥眭祠轲戾泸狒弩狒镱沐眭祠轲戾鲠祯瀛忾钿ㄩ铋轭篝蝓泗轱铙疳蝮瀛轭瘐轭瘐舂戾舄è骈钺飙蝈篚祠蝈漉沐＇滹轭篝蝓泗轱瞽拱氨轭篝蝓泗轱铙洪铋糸犰鲠祯轭轸┅ㄨ遽潴磲疸狎＇汜骈钺飙蝈篚祠┅ㄦ矧磲铋窿桢徜螬┅换疳蝮瀛轭瘐换换勰换畚勖换圳弁坌换换换盹鲥骝镯麸换盹鲥骝镯麸换盹鲥骝镯麸换盹鲥骝镯麸换换骄è⑽②á蘑⒚⑼á孝┅换è暴ǔ畅ú暴ū博ㄤ彐躅疳蝮瀛轭瘐ㄩ铕豸⒃犭弩箦蜷犰辁邃泸狒篝徙犷蝈趱蝾翳篝徙塍犷翳轭篝蝓泗轱铙徭翦蝼狎潴戾舄è狍扉铄ㄣ飙痧泸搴箴扉④茴轭瘐舂蝈戾鲠铘扉铄蝈鲥蝮祜镳骘轭狍扉铄躅糸ㄥ聃犰泔祆邈飑┅疳蝮邃蝻黧祜镳骘蝻轭ㄣ潋蝈戾鲠铘扉铄螬泔祆邈ㄧ弭泔蝻鳗┅箦蜷犰辁邃篝徙塍蝈漉沐＇徙悱蝻黧疳蝮邃蝻黧洪铋糸犰鲠祯磲脲扉篝戾铉翳ㄣ狎疳蝮邃蝻黧┅┅蜥鳝轭篝祜镳骘镱狍扉铄怡＇沅殒ㄥ聃犰ㄣ狎飑蝈趱蝾ㄣ潋飑┅疳蝮邃轭篝祜镳骘轭篝轭蜥鳝轭篝泔祆邈磲疸狎＇疳蝮瀛轭翦珏ㄣ飙痧泸搴犰飙磲翥桢蟓狍篝蜷铉④茕轭篝颟┅┅鲠祯弩箦蜷犰辁邃篝徙塍疳蝮邃轭篝颟┅换ㄧ弭泔勰换骄铋⒛铋飑ㄤ彐躅珏舡泔蝻鳗⑶轹孱蝻鳜疳蝮翳泔铘孱趔矧灬汶镦泔铘孱趔轭遽汨泔祯眍轭翳狒蝻鳍磲疸狎灬礅溽螬ㄣ狎ㄣ飙痧泸搴犰飙磲翥桢蟓狍篝蜷铉④荀螬┅ㄣ飙痧泸搴犰飙磲翥桢蟓狍篝蜷铉ㄜ荏除苘圮荀苘荸苘罂蝻鳗┅换ㄡ沣蝻黧扉篝铋铋铋飑á立⒙⒚┅换骄Жá立换á垄换á芒┅换换ㄡ沣蝻黧è⒘á垄á芒┅á蘑铋⑵┅换骄Жá立⒛换á垄换á芒⑵┅ㄤ彐躅徙悱蝻黧蝻黧扉铄⒘滗蝻黧轭麸麸扉篝镦泔祯眍蟑篝徙塍痱镧祜镳骘泸狒轭扉铄骘痫骝镯殒篝蜷铉泸狒濠换滹瞌瘐箬铋滹瘐箬泸狒铘痫蝻黧┅蝻黧┅换ㄤ锃轭篝蝓泗轱Жá微②á蘑⒚⑼á孝┅换ú暴换骄Жá芒⒛⑽②换á廷换á孝┅ㄤ彐躅滹轭篝蝓泗轱ㄣ蜥翦轭篝蝓泗轱瞟⒁邈殄鲥翳泸狒弩犷犷轭篝蝓泗轱瞵犷屮邈豸翳轭篝蝓泗轱镱翳泸狒弩娘弩铒镳弪狒轭痨徙瀹惋鲥镱泸狒狒糸礤ㄤ弩趄蹉趱蜷铉忾钿铛憝泸狒弩骝镯麸扉篝ㄦ轵篝轭篝蝓泗轱瞟ū箦泔钿轭篝蝓泗轱瞟ū翳轵轭篝蝓泗轱瞟┅戾è骝镯篝铘骝镯泸狒弩┅麸篝铘麸泸狒弩┅铄鳝泸狒弩ㄣ镳趄邋泸狒弩┅换疑翳玑蜮徵泔祆邈麸痱镧祜镳蝈疱狒铛憝泸狒弩泔祆邈痱镧瘐箬ㄣ狎骝镯篝氅麸篝氅痫骝镯篝氅┅箦翩铘骝镯铄鳝泸狒弩骝镯篝氅箦翩铘麸铄鳝泸狒弩麸篝氅铄鳝泸狒弩┅换ㄤ锃轭篝蝓泗轱Жá微②á蘑⒚⑼á孝┅换ú暴换骄Жá蘑⒚⑽②换á廷换á孝┅ㄤ彐躅滹轭篝蝓泗轱瞽拱氨ㄣ蜥翦轭篝蝓泗轱瞟⒁邈殄鲥翳泸狒弩犷犷轭篝蝓泗轱瞵犷屮邈豸翳轭篝蝓泗轱镱翳泸狒弩娘弩铒镳弪狒轭痨徙瀹惋鲥篝徙塍镦泸狒弩ㄤ弩趄蹉趱蜷铉忾钿铛憝泸狒弩骝镯麸扉篝ㄦ轵篝轭篝蝓泗轱瞟ū箦泔钿轭篝蝓泗轱瞟ū翳轵轭篝蝓泗轱瞟┅戾舄è骝镯篝铘骝镯泸狒弩┅麸篝铘麸泸狒弩┅铄鳝泸狒弩ㄣ镳趄邋泸狒弩┅换疑翳玑蜮徵泔祆邈麸篚怏翎汶篚怏羼骝镯篝铛憝泸狒弩┅痱镧箦翩铘骝镯铄鳝泸狒弩篚怏羼骝镯篝铛憝泸狒弩┅箦翩铘麸铄鳝泸狒弩ㄡ痧孱篚怏翎汶麸篝氅┅铄鳝泸狒弩┅换ㄤ锃轭篝蝓泗轱Жá微②á蘑⒚⑼á孝┅换ú暴换骄Жá芒⒛⑽②换á廷换á孝┅ㄤ彐躅钿锃轭篝蝓泗轱ㄣ蜥翦轭篝蝓泗轱瞟⒁邈殄鲥翳泸狒弩犷犷轭篝蝓泗轱瞵犷屮邈豸翳轭篝蝓泗轱镱翳泸狒弩腻篝蝓泗轹瀹惋鲥镱泸狒狒糸礤ㄤ弩趄蹉趱蜷铉忾钿铛憝泸狒弩骝镯麸扉篝ㄦ轵篝轭篝蝓泗轱瞟ū箦泔钿轭篝蝓泗轱瞟ū翳轵轭篝蝓泗轱瞟┅祜镳蝈疱狒铛憝泸狒弩泔祆邈瘐箬痫铘骝镯泸狒弩┅铘麸泸狒弩┅泸狒弩┅换ㄤ锃轭篝蝓泗轱Жá微②á蘑⒚⑼á孝┅换ú暴换骄Жá蘑⒚⑽②换á廷换á孝┅ㄤ彐躅钿锃轭篝蝓泗轱瞽拱氨ㄣ蜥翦轭篝蝓泗轱瞟⒁邈殄鲥翳泸狒弩犷犷轭篝蝓泗轱瞵犷屮邈豸翳轭篝蝓泗轱镱翳泸狒弩腻篝蝓泗轹瀹惋鲥篝徙塍镦泸狒弩ㄤ弩趄蹉趱蜷铉忾钿铛憝泸狒弩骝镯麸扉篝ㄦ轵篝轭篝蝓泗轱瞟ū箦泔钿轭篝蝓泗轱瞟ū翳轵轭篝蝓泗轱瞟┅痱镧箦翩铘麸泸狒弩钽镱篚怏羼铘骝镯泸狒弩铛憝泸狒弩铘麸泸狒弩┅祜镳蝈疱狒铛憝泸狒弩滹痫铘骝镯泸狒弩┅泸狒弩┅